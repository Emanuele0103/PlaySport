<div class="settings-container">
  <div class="back-wrapper">
    <button class="back-button" (click)="goBack()" aria-label="Torna indietro">
      <i class="fas fa-arrow-left"></i>
    </button>
  </div>


  <h2 class="settings-title">Impostazioni Utente</h2>

  <div class="button-group full-width">
    <button class="settings-button full" [routerLink]="['/le-mie-prenotazioni']">
      <i class="fas fa-calendar-alt"></i> Le mie prenotazioni
    </button>
  </div>

  <div class="button-group">
    <button class="settings-button" (click)="showProfileForm()">
      <i class="fas fa-user-edit"></i> Modifica Profilo
    </button>
  </div>


  <!-- Bottone elimina account -->
  <button class="settings-button danger full" (click)="confirmDelete()">
    <i class="fas fa-trash-alt"></i> Elimina il mio account
  </button>


  <!-- Modulo modifica profilo -->
  <div *ngIf="isProfileEditing" class="profile-form">
    <h3>Modifica Profilo</h3>

    <form (ngSubmit)="updateProfile()" #profileForm="ngForm">
      <!-- Email -->
      <input type="email" [(ngModel)]="user.email" name="email" placeholder="Email" required />

      <!-- Avatar upload -->
      <label class="upload-label">
        <i class="fas fa-upload"></i> Carica nuova foto profilo
        <input type="file" id="avatar" (change)="onFileSelected($event)" hidden />
      </label>
      <span class="file-name" *ngIf="selectedFile?.name">
        âœ… {{ selectedFile.name }}
      </span>


      <!-- Cambia Password integrato -->
      <h4>Cambia Password (opzionale)</h4>
      <input type="password" [(ngModel)]="oldPassword" name="oldPassword" placeholder="Vecchia password" />
      <input type="password" [(ngModel)]="newPassword" name="newPassword" placeholder="Nuova password" />

      <button type="submit" class="settings-button">
        <i class="fas fa-save"></i> Salva
      </button>

    </form>

    <!-- Feedback -->
    <p *ngIf="feedbackMessage" class="success">{{ feedbackMessage }}</p>
    <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>
  </div>
</div>